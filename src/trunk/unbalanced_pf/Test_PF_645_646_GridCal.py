import numpy as np

U1 = np.array([1.0420 * np.exp(1j * (-121.72*np.pi/180)),
               1.0174 * np.exp(1j * (117.83*np.pi/180))])

U2 = np.array([1.03708067 * np.exp(1j * (-122.38*np.pi/180)),
               1.01011028 * np.exp(1j * (117.4*np.pi/180))])

U3 = np.array([1.03793653 * np.exp(1j * (-122.74*np.pi/180)),
               1.00489104 * np.exp(1j * (117.17*np.pi/180))])

Ys12 = np.array([[0.75018946-0.68996668j, -0.25000302+0.10376509j],
                 [-0.25000302+0.10376509j, 0.74501133-0.6931314j]])

Ysh12 = np.array([[0.+0.07718218j, 0.-0.01474749j],
                  [0.-0.01474749j, 0.+0.07646275j]])/2

Ys23 = np.array([[1.25031577-1.14994447j, -0.4166717 +0.17294182j],
                 [-0.4166717 +0.17294182j, 1.24168554-1.15521901j]])

Ysh23 = np.array([[0.+0.04630931j, 0.-0.00884849j],
                  [0.-0.00884849j, 0.+0.04587765j]])/2

Sb = 170e3 / 100e6 / 3 + 1j * 125e3 / 100e6 / 3

Sbc = 230e3 / 100e6 / 3 + 1j * 132e3 / 100e6 / 3

"""
Currents
"""
I3_b = np.conj( Sbc / (U3[0] - U3[1]) )
I3_c = np.conj( Sbc / (U3[1] - U3[0]) )

Ish23 = Ysh23 @ U3

Is23 = Ys23 @ (U2 - U3)

I3 = Is23 - Ish23
print(I3)
print()
print(I3_b)
print(I3_c)